# zksync

## ZKsync Era
ZKsync Era 是第 2 层 ZK rollup，一种无需信任的协议,计算在链下进行，大部分数据也存储在链下,交易被捆绑成批。由于所有有效性证明都在以太坊上得到证明，因此用户享有与 L1 相同的安全保证。

## zkSync 上开发注意点

- 转账时使用 call 而不是 transfer 或 send：transfer 和 send 函数限制了发送 ETH 时的 gas 消耗，上限为 2300 gas。而 zkSync 的账户都是智能合约，转账时消耗可能因为超出 2300，导致交易失败。因此，智能合约应使用没有 gas 消耗上限的 call。
- 使用可升级合约：zkSync Era 还在开发早期，虽然团队进行了广泛的测试来确保 EVM 兼容性，但问题仍然可能会出现。因此，部署合约时应尽量使用可升级的代理合约，应对可能发生的问题。

## 账户抽象（Account Abstraction，AA）
将用户账户的操作和特性从底层区块链平台的具体实现中分离出来的设计思想。通过这种方式，用户和开发者可以以更加简便、直观的方式与区块链互动，同时能够享受到定制化服务和更用户友好的操作。

## 传统的以太坊网络中账户分类
- 外部拥有账户（EOA）：由私钥控制，可以直接发起交易。
    - 免费创建。
    - 能够直接发起交易。
    - 主要进行 ETH 和代币转移。
    - 由一对密钥控制。
- 合约账户：由部署在区块链上的智能合约代码控制，能够执行更复杂的操作。
    - 部署需消耗 gas。
    - 仅在接收到交易时能发起交易。
    - 可以执行多样化的逻辑，如多签钱包，社交恢复，代付 gas 费用等。
    - 无私钥，完全由代码逻辑控制。

## 账户抽象化的优势
账户抽象化将 EOA 和合约账户的特性统一，允许账户既能自主发起交易，又能承载复杂的逻辑。这极大地扩展了区块链账户的应用范围，使得例如智能合约钱包等应用成为可能，同时简化了用户的操作流程和为用户的资金安全提供了更安全的保障。

## zkSync 中的账户抽象
- zkSync 与 EIP4337 的区别

## Paymaster：zkSync 中的支付中继
- 用户发起交易时，可以指定一个 Paymaster 合约来负责支付交易费用。
- Paymaster 合约在接到支付请求后，会根据内部逻辑验证请求的有效性，并决定是否支付交易费用。
- 如果 Paymaster 同意支付，它会向网络支付所需的费用，使用户交易得以执行。

## 应用场景
- 用户免费交易
- 代币支付交易费
- NFT 权限给予
- 企业和应用赞助

## zkSync 账户抽象的应用
- 简化交易流程：更容易地与智能合约交互，无需担心底层的复杂性。
- 定制化服务：如自动交易、资产管理策略等，提升了应用的灵活性和功能性。
- 增强的安全性：通过支持多种签名方案和支付方式，账户抽象化为用户和应用提供了更强的安全性和更多样的交易支付选项。
- 智能合约钱包
- 去中心化金融（DeFi）应用：用户可以直接从其账户中执行复杂的金融操作，如借贷、杠杆交易等，无需转移到外部合约。
- 自动化支付和订阅：定制智能合约以自动执行定期支付，支持订阅服务和定期费用支付，无需用户手动介入。

## 
